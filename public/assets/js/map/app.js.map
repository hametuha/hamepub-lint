{"version":3,"sources":["app.js"],"names":["$","showMessage","messages","success","markup","join","$message","after","document","ready","submit","e","preventDefault","version","val","$form","this","files","get","length","file","callback","reader","FileReader","readAsDataURL","onload","result","onerror","error","alert","getBase64","replace","addClass","url","attr","ajax","method","data","done","response","fail","resopnse","message","responseJSON","status","always","removeClass","jQuery"],"mappings":"CAMA,SAAWA,GAEP,aAEA,IAWIC,EAAc,SAASC,EAAUC,GACjC,IAAIC,EAAS,4BAA+BD,EAAU,UAAY,UAAa,8CAC/EC,GAAU,wCAA2CD,EAAU,WAAa,aAAgB,YAC5FC,GAAUF,EAASG,KAAK,UACxBD,GAAU,OACVA,GAAU,+HAIV,IAAIE,EAAWN,EADfI,GAAU,UAEVJ,EAAE,aAAaO,MAAMD,IAKzBN,EAAEQ,UAAUC,MAAM,WAEdT,EAAE,aAAaU,OAAO,SAASC,GAC3BA,EAAEC,iBACF,IAAIC,EAAUb,EAAE,gBAAgBc,MAC5BC,EAAQf,EAAEgB,MAEVC,EAAQjB,EAAE,aAAakB,IAAI,GAAGD,MAC9BA,EAAME,OAlCF,SAAUC,EAAMC,GAC5B,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,cAAcJ,GACrBE,EAAOG,OAAS,WACZJ,EAASC,EAAOI,SAEpBJ,EAAOK,QAAU,SAAUC,GACvBC,MAAO,4BAA8BD,IAgCrCE,CAAUb,EAAM,GAAI,SAASS,GACzBA,EAASA,EAAOK,QAAQ,mBAAoB,IAC5ChB,EAAMiB,SAAS,WACf,IAAIC,EAAMlB,EAAMmB,KAAK,UAAY,IAAMrB,EAC7Bb,EAAE,eACZA,EAAEmC,KAAKF,GACHG,OAAQ,OACRC,KAAMX,IACPY,KAAK,SAASC,GACbtC,EAAYsC,EAASrC,SAAUqC,EAASpC,WACzCqC,KAAK,SAASC,GACb,IAAIC,EAAU,kBACXH,SAASI,cAAgBJ,SAASI,aAAazC,WAC9CwC,EAAUH,SAASI,aAAaC,OAAS,KAAOL,SAASI,aAAazC,SAASG,KAAK,OAExFJ,GAAayC,IAAU,KACxBG,OAAO,WACN9B,EAAM+B,YAAY,eArBtBjB,MAAM,2BAvCtB,CAoEGkB","file":"../app.js","sourcesContent":["/**\n * Description\n */\n\n/*global hoge: true*/\n\n(function ($) {\n\n    'use strict';\n\n    var getBase64 = function (file, callback) {\n        var reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = function () {\n            callback(reader.result);\n        };\n        reader.onerror = function (error) {\n            alert( 'Failed to encode BASE64: ' + error );\n        };\n    };\n\n    var showMessage = function(messages, success){\n        var markup = '<div class=\"alert alert-' + ( success ? 'success' : 'danger' ) + ' alert-dismissible fade show\" role=\"alert\">';\n        markup += '<h4 class=\"alert-heading\">Your ePub ' + ( success ? 'is VALID' : 'has ERROR' ) + '!</h4><p>';\n        markup += messages.join('<br />');\n        markup += '</p>';\n        markup += '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">' +\n                  '<span aria-hidden=\"true\">&times;</span>' +\n                  '</button>';\n        markup += '</div>';\n        var $message = $(markup);\n        $('.try-form').after($message);\n    };\n\n\n\n    $(document).ready(function(){\n\n        $('.try-form').submit(function(e){\n            e.preventDefault();\n            var version = $('#try-version').val();\n            var $form = $(this);\n\n            var files = $('#try-file').get(0).files;\n            if(!files.length){\n                alert('Please select file!');\n                return;\n            }\n\n            getBase64(files[0], function(result){\n                result = result.replace(/^data:.*;base64,/, '');\n                $form.addClass('loading');\n                var url = $form.attr('action') + '/' + version;\n                var msg = $('<div></div>')\n                $.ajax(url, {\n                    method: 'POST',\n                    data: result\n                }).done(function(response){\n                    showMessage(response.messages, response.success);\n                }).fail(function(resopnse){\n                    var message = 'Error occurred.';\n                    if(response.responseJSON && response.responseJSON.messages){\n                        message = response.responseJSON.status + ': ' + response.responseJSON.messages.join(\"\\n\");\n                    }\n                    showMessage([message], false);\n                }).always(function(){\n                    $form.removeClass('loading');\n                });\n            });\n        });\n\n    });\n\n\n})(jQuery);\n"]}